<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>P-Value Selection Models for Meta-Analysis with Dependent Effects ‚Ä¢ metaselection</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="P-Value Selection Models for Meta-Analysis with Dependent Effects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metaselection</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/selection_models.html">P-Value Selection Models for Meta-Analysis with Dependent Effects</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jepusto/metaselection/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>P-Value Selection Models for Meta-Analysis with Dependent Effects</h1>
            
            <h4 data-toc-skip class="date">2024-10-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jepusto/metaselection/blob/HEAD/vignettes/selection_models.Rmd" class="external-link"><code>vignettes/selection_models.Rmd</code></a></small>
      <div class="d-none name"><code>selection_models.Rmd</code></div>
    </div>

    
    
<p>A meta-analysis aims to provide a comprehensive synthesis of
available evidence on a topic of interest. One major challenge to this
aim is selective reporting of evidence from primary studies. Selective
reporting occurs when the statistical significance level of a finding
affects whether it is reported and therefore whether the finding is
available for inclusion in a meta-analysis. If statistically
significant, affirmative results are more likely to be reported compared
to null, non-affirmative results, the evidence base available for
meta-analysis will be distorted, leading to inflation of effect size
estimates from meta-analysis and bias in estimates of heterogeneity.</p>
<p>Because selective reporting makes it difficult to draw accurate
conclusions from a synthesis, many tools have been developed that try to
detect selective reporting problems and to correct for the biases it
creates in meta-analytic summaries. Widely used methods include:
graphical diagnostics like funnel plots; tests and adjustments for
funnel plot asymmetry such as trim-and-fill, Egger‚Äôs regression, and
PET/PEESE; selection models; and p-value diagnostics such as p-curve and
p-uniform. However, very few methods available for investigating
selective reporting can accommodate dependent effect sizes. This
limitation poses a problem for meta-analyses in education, psychology
and other social sciences, where dependent effects are a very common
feature of meta-analytic data.</p>
<p>Dependent effect sizes occur when primary studies report multiple
measures of the outcomes or repeated measures of the outcome. Generally,
failing to account for dependency can result in misleading conclusions,
overly narrow confidence intervals, and hypothesis tests that have
inflated type one error rates.</p>
<p>In this package, we provide methods for investigating and accounting
for selective reporting based on p-value selection models. The methods
account for dependent effect sizes by using cluster-robust variance
estimation (i.e., sandwich estimation) or clustered bootstrapping
techniques. Simulation results show that selection models combined with
robust variance estimation led to low bias in the estimate of the
overall effect size. Combining the selection models with
cluster-bootstrapping leads to confidence intervals with
close-to-nominal coverage rates.</p>
<div class="section level2">
<h2 id="p-value-selection-models">P-Value Selection Models<a class="anchor" aria-label="anchor" href="#p-value-selection-models"></a>
</h2>
<p>P-value selection models are a general set of methods that correct
for selective reporting by modeling the process by which the effect size
estimates are reported <span class="citation">(<a href="#ref-rothstein_selection_2006">Hedges &amp; Vevea,
2006</a>)</span>. Selection models have two components: a model
describing the evidence generation process and model describing the
selection process. The <code>metaselection</code> package implements a
very flexible class of selection models, in which the
evidence-generating process follows a random effects location-scale
model <span class="citation">(<a href="#ref-viechtbauer_locationscale_2022">Viechtbauer &amp;
L√≥pez‚ÄêL√≥pez, 2022</a>)</span> and where the selection process is a
function of one-sided p-values, either in the form of a step function
<span class="citation">(<a href="#ref-vevea_general_1995">Vevea &amp;
Hedges, 1995</a>)</span> or a beta-density function <span class="citation">(<a href="#ref-citkowicz_parsimonious_2017">Citkowicz
&amp; Vevea, 2017</a>)</span>. Step function model involves specifying
steps which categorize the p-values into intervals that have different
probabilities of selection <span class="citation">(<a href="#ref-vevea_general_1995">Vevea &amp; Hedges, 1995</a>)</span>. The
beta-density model uses a different selection function, based on a beta
distribution, to capture complex patterns of selection <span class="citation">(<a href="#ref-citkowicz_parsimonious_2017">Citkowicz
&amp; Vevea, 2017</a>)</span>.</p>
<p>Consider a meta-analytic dataset with a total of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
studies, where study
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
includes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>j</mi></msub><annotation encoding="application/x-tex">k_j</annotation></semantics></math>
effect size estimates. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
denote an effect size estimate produced by a study, prior to selective
reporting. The effect size estimate has standard error
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{ij}</annotation></semantics></math>,
which is treated as a fixed quantity. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{x}_{ij}</annotation></semantics></math>
be a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>√ó</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">1 \times x</annotation></semantics></math>
row vector of predictors that encode characteristics of the effect size
and/or the study and may be related to average effect size magnitude.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùêÆ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{u}_{ij}</annotation></semantics></math>
be a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>√ó</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">1 \times u</annotation></semantics></math>
row vector of predictors that may be related to effect size
heterogeneity. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ¶</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi()</annotation></semantics></math>
denote the standard normal cumulative distribution function and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œï</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi()</annotation></semantics></math>
the standard normal density. Finally, let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">p_{ij}</annotation></semantics></math>
be the one-sided p-value corresponding to the effect size estimate,
which is a function of the effect size estimate and its standard error:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>‚àí</mo><mi>Œ¶</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>/</mi><msub><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Œ¶</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>/</mi><msub><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{ij} = 1 - \Phi\left(Y_{ij} / \sigma_{ij}\right) = \Phi\left(-Y_{ij} / \sigma_{ij}\right)</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="the-evidence-generating-process">The evidence-generating process<a class="anchor" aria-label="anchor" href="#the-evidence-generating-process"></a>
</h3>
<p>The model for the evidence-generating process is a random effects
location-scale model, in which
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>ùê±</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>ùõÉ</mi><mo>+</mo><msub><mi>v</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
Y_{ij} = \mathbf{x}_{ij} \boldsymbol\beta + v_{ij} + e_{ij},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÉ</mi><annotation encoding="application/x-tex">\boldsymbol\beta</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>√ó</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">1 \times x</annotation></semantics></math>
vector of regression coefficients that relate the predictors to average
effect size magnitude,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mi>i</mi></msub><annotation encoding="application/x-tex">v_i</annotation></semantics></math>
is a normally distributed random effect with mean zero and variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÑ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\tau^2_{ij}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>i</mi></msub><annotation encoding="application/x-tex">e_i</annotation></semantics></math>
is a normally distributed sampling error with mean zero and known
variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo>*</mo><mn>2</mn></mrow></msubsup><annotation encoding="application/x-tex">\sigma^{*2}_{ij}</annotation></semantics></math>.
The variance of the random effects is modeled as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œÑ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùêÆ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>ùõÑ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">
\log\left(\tau_{ij}^{2}\right) = \mathbf{u}_{ij} \boldsymbol\gamma,
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõÑ</mi><annotation encoding="application/x-tex">\boldsymbol\gamma</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>√ó</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">u \times 1</annotation></semantics></math>
vector of coefficients that relate the predictors to the degree of
marginal variation in the random effects. If the model does not include
predictors of heterogeneity, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÆ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathbf{u}_{ij} = 1</annotation></semantics></math>
and the model reduces to a conventional random effects meta-regression
in which
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>œÑ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\gamma = \log(\tau^2)</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="the-selective-reporting-process">The selective reporting process<a class="anchor" aria-label="anchor" href="#the-selective-reporting-process"></a>
</h3>
<p>The selective reporting process is defined by a selection function,
which specifies how the probability that a given effect size estimate is
reported varies depending on its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value.
Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">O_{ij}</annotation></semantics></math>
be an indicator for whether effect size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in study
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
is observed. Then the selection model defines
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.222em"></mspace><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.222em"></mspace><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Pr}(O_{ij} = 1 \ | \ p_{ij}) = \text{Pr}(O_{ij} = 1 \ | \ Y_{ij}, \sigma_{ij})</annotation></semantics></math>.
The distribution of observed effect sizes then corresponds to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>y</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.222em"></mspace><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.222em"></mspace><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>y</mi><mo>,</mo><msub><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>√ó</mo><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>y</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.222em"></mspace><msub><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mspace width="0.222em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.222em"></mspace><msub><mi>œÉ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{Pr}(Y_{ij} = y \ | \ O_{ij} = 1) = \frac{\text{Pr}(O_{ij} = 1 \ | \ Y_{ij} = y, \sigma_{ij}) \times \text{Pr}(Y_{ij} = y \ | \ \sigma_{ij})}{\text{Pr}(O_{ij} = 1 \ | \ \sigma_{ij})}.
</annotation></semantics></math> In the above, the first term in the
numerator is defined by the selective reporting process and the second
term is defined by the evidence-generating process.</p>
<p><span class="citation">Hedges (<a href="#ref-hedges_modeling_1992">1992</a>)</span> and <span class="citation">Vevea &amp; Hedges (<a href="#ref-vevea_general_1995">1995</a>)</span> proposed to model the
selective reporting process using a step-function, with thresholds
chosen to correspond to ‚Äúpsychologically salient‚Äù
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values.
In the general formulation, we have steps
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Œ±</mi><mi>H</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_1,...,\alpha_H</annotation></semantics></math>
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>O</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if</mtext></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>Œ±</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∂</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if</mtext></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Œ±</mi><mn>1</mn></msub><mo>‚â§</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>Œ±</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∂</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if</mtext></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Œ±</mi><mn>2</mn></msub><mo>‚â§</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>Œ±</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>‚ãÆ</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œ∂</mi><mi>H</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">if</mtext></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Œ±</mi><mi>H</mi></msub><mo>‚â§</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>.</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{Pr}(O_{ij} = 1 | p_{ij}) = \begin{cases}
1 &amp; \text{if} &amp; p_{ij} &lt; \alpha_1 \\ 
\exp(\zeta_1) &amp; \text{if} &amp; \alpha_1 \leq p_{ij} &lt; \alpha_2 \\ \exp(\zeta_2) &amp; \text{if} &amp; \alpha_2 \leq p_{ij} &lt; \alpha_3 \\
\vdots \\
\exp(\zeta_H) &amp; \text{if} &amp; \alpha_H \leq p_{ij}.
\end{cases}
</annotation></semantics></math> The selection parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∂</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>Œ∂</mi><mi>H</mi></msub></mrow><annotation encoding="application/x-tex">\zeta_1,...,\zeta_H</annotation></semantics></math>
control the probabilities of selection given a p-value, with parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∂</mi><mi>h</mi></msub><annotation encoding="application/x-tex">\zeta_h</annotation></semantics></math>
defined as the log of the probability that an effect size estimate is
observed, given that its p-value is in the range
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><msub><mi>Œ±</mi><mi>h</mi></msub><mo>,</mo><msub><mi>Œ±</mi><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">[\alpha_h, \alpha_{h+1})</annotation></semantics></math>,
relative to the probability than effect size estimate is observe, given
that its p-value is in the range
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><msub><mi>Œ±</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">[0, \alpha_1)</annotation></semantics></math>.
We use log-transformed probabilities so that the parameter space is
unrestricted,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mi>‚àû</mi><mo>&lt;</mo><msub><mi>Œ∂</mi><mi>h</mi></msub><mo>&lt;</mo><mo>+</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">-\infty &lt; \zeta_h &lt; +\infty</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">h=1,...,H</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∂</mi><mn>1</mn></msub><mo>=</mo><mi>‚ãØ</mi><mo>=</mo><msub><mi>Œ∂</mi><mi>H</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta_1 = \cdots = \zeta_H = 0</annotation></semantics></math>
therefore describes a process where effect sizes are reported with
uniform probability, regardless of their statistical significance
level.</p>
<p>In practice, meta-analysts will often use only a small number of
steps in the selection model. One common choice is the three-parameter
selection model, which has a single step at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ±</mi><mo>=</mo><mn>.025</mn></mrow><annotation encoding="application/x-tex">\alpha = .025</annotation></semantics></math>.
With this choice of threshold, positive effects that are statistically
significant at the two-sided level of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">p &lt; .05</annotation></semantics></math>
have a different probability of selection than effects that are not
statistically significant or not in the anticipated direction. Another
possibility is to use two steps at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mn>1</mn></msub><mo>=</mo><mn>.025</mn></mrow><annotation encoding="application/x-tex">\alpha_1 = .025</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mn>2</mn></msub><mo>=</mo><mn>.500</mn></mrow><annotation encoding="application/x-tex">\alpha_2 = .500</annotation></semantics></math>,
which allows for different probabilities of selection for effects that
are positive but not statistically significant and effects that are
negative (i.e., in the opposite the intended direction). We call the
latter model a four-parameter selection model.</p>
<!-- Martyna, can you add a paragraph on the beta function model? -->
</div>
<div class="section level3">
<h3 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h3>
</div>
<div class="section level3">
<h3 id="cluster-robust-variance-estimation">Cluster-robust variance estimation<a class="anchor" aria-label="anchor" href="#cluster-robust-variance-estimation"></a>
</h3>
</div>
<div class="section level3">
<h3 id="bootstrapped-confidence-intervals">Bootstrapped Confidence Intervals<a class="anchor" aria-label="anchor" href="#bootstrapped-confidence-intervals"></a>
</h3>
<p>To improve confidence interval coverage, X (2025) also examined
bootstrapping the selection models to obtain the confidence intervals.
Bootstrapping involves re-sampling many times from the original data to
create an empirical distribution that can be use in place of the
sampling distribution to estimate measures of uncertainty <span class="citation">(<a href="#ref-boos2003introduction">Boos,
2003</a>)</span>. X (2025) examined variations of bootstrapping
approaches combined with different confidence interval calculations. The
results showed that regular cluster bootstrapping with percentile
confidence intervals performed the best. The modified selection models
combined with this bootstrapping led to close to nominal coverage
rates.</p>
</div>
</div>
<div class="section level2">
<h2 id="using-the-metaselection-package">Using the <code>metaselection</code> package<a class="anchor" aria-label="anchor" href="#using-the-metaselection-package"></a>
</h2>
<p>We now demonstrate the key functions from the
<code>metaselection</code> package. As a running example, We data from a
meta-analysis by <span class="citation">Lehmann, Elliot, &amp;
Calin-Jageman (<a href="#ref-lehmann2018meta">2018</a>)</span>, who
examined the effects of the color red on attractiveness judgments. The
dataset is available in the <code>metadat</code> package <span class="citation">(<a href="#ref-metadat">White, Noble, Senior, Hamilton,
&amp; Viechtbauer, 2022</a>)</span> as <code>dat.lehmann2018</code>. It
consists of 81 effect sizes from 41 studies. The following code loads
the dataset and creates variables that will be needed for the subsequent
analysis.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dat.lehmann2018"</span>, package <span class="op">=</span> <span class="st">"metadat"</span><span class="op">)</span></span>
<span><span class="va">dat.lehmann2018</span><span class="op">$</span><span class="va">study</span> <span class="op">&lt;-</span> <span class="va">dat.lehmann2018</span><span class="op">$</span><span class="va">Full_Citation</span></span>
<span><span class="va">dat.lehmann2018</span><span class="op">$</span><span class="va">sei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dat.lehmann2018</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="va">dat.lehmann2018</span><span class="op">$</span><span class="va">esid</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat.lehmann2018</span><span class="op">)</span> </span></code></pre></div>
<div class="section level3">
<h3 id="prelminary-analysis">Prelminary Analysis<a class="anchor" aria-label="anchor" href="#prelminary-analysis"></a>
</h3>
<p>As a point of comparison, we first run an analysis that ignores the
possibility of selective reporting bias but accounts for the dependence
structure of the effect sizes using a correlated-and-heirarchical
effects working model and cluster-robust variance estimation <span class="citation">(<a href="#ref-pustejovsky2022preventionscience">Pustejovsky &amp; Tipton,
2022</a>)</span>. The following code first creates a sampling
variance-covariance matrix assuming that effect size estimates from the
same study have sampling errors that are correlated at 0.8; it then fits
a correlated-and-heirarchical effects working model and applies robust
variance estimation, clustering by study.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.metafor-project.org" class="external-link">metafor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://jepusto.github.io/clubSandwich/" class="external-link">clubSandwich</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create sampling variance-covariance matrix</span></span>
<span><span class="va">V_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metafor/reference/vcalc.html" class="external-link">vcalc</a></span><span class="op">(</span></span>
<span>  vi <span class="op">=</span> <span class="va">vi</span>, </span>
<span>  cluster <span class="op">=</span> <span class="va">study</span>,</span>
<span>  obs <span class="op">=</span> <span class="va">esid</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat.lehmann2018</span>,</span>
<span>  rho <span class="op">=</span> <span class="fl">.8</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First CHE working model</span></span>
<span><span class="va">CHE_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.mv.html" class="external-link">rma.mv</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>, V <span class="op">=</span> <span class="va">V_mat</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">study</span> <span class="op">/</span> <span class="va">esid</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat.lehmann2018</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span><span class="co"># Apply RVE with small-sample corrections, clustering by study</span></span>
<span>  <span class="fu"><a href="https://wviechtb.github.io/metafor/reference/robust.html" class="external-link">robust</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="va">study</span>, clubSandwich <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CHE_mod</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Multivariate Meta-Analysis Model (k = 81; method: REML)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Variance Components:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             estim    sqrt  nlvls  fixed      factor </span></span>
<span><span class="co">## sigma^2.1  0.0494  0.2223     41     no       study </span></span>
<span><span class="co">## sigma^2.2  0.0737  0.2715     81     no  study/esid </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Test for Heterogeneity:</span></span>
<span><span class="co">## Q(df = 80) = 453.5173, p-val &lt; .0001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of estimates:   81</span></span>
<span><span class="co">## Number of clusters:    41</span></span>
<span><span class="co">## Estimates per cluster: 1-6 (mean: 1.98, median: 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Results:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## estimate      se¬π    tval¬π     df¬π    pval¬π   ci.lb¬π   ci.ub¬π     </span></span>
<span><span class="co">##   0.2168  0.0607   3.5695   35.75   0.0010   0.0936   0.3400   ** </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 1) results based on cluster-robust inference (var-cov estimator: CR2,</span></span>
<span><span class="co">##    approx t-test and confidence interval, df: Satterthwaite approx)</span></span></code></pre>
<p>The overall estimate of the average effect is 0.217, 95% CI [0.094,
0.34], which is significantly different from zero (p = 0.001). The
estimated total heterogeneity (including both between- and within-study
heterogeneity) is 0.123, corresponding to a total standard deviation of
0.351. Next, we examine how this average effect size estimate differs
from the estimates based on a step-function or beta-function selection
model, fitted using the <code>metaselection</code> package.</p>
</div>
<div class="section level3">
<h3 id="three-parameter-step-function-with-rve">Three-Parameter Step Function with RVE<a class="anchor" aria-label="anchor" href="#three-parameter-step-function-with-rve"></a>
</h3>
<p>The primary function for fitting p-value selection models is
<code><a href="../reference/selection_model.html">selection_model()</a></code>. In the code below, we fit a
step-function selection model to the <code>dat.lehmann2018</code> data
using the <code><a href="../reference/selection_model.html">selection_model()</a></code> function. We specify which
variable is the effect size, <code>yi</code>, and which is the standard
error for the effect size, <code>sei</code>. We indicate that we want to
estimate <code>"step"</code> selection model and specify a single step
at .025 by setting <code>step = 0.025</code>. By default, the function
fits the modeling using composite maximum likelihood estimation and
calculates standard errors and confidence intervals using cluster-robust
variance estimation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jepusto/metaselection" class="external-link">metaselection</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_3PSM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selection_model.html">selection_model</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat.lehmann2018</span>, </span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  cluster <span class="op">=</span> <span class="va">study</span>,</span>
<span>  selection_type <span class="op">=</span> <span class="st">"step"</span>,</span>
<span>  steps <span class="op">=</span> <span class="fl">.025</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_3PSM</span></span></code></pre></div>
<pre><code><span><span class="co">##  param    Est    SE  CI_lo  CI_hi</span></span>
<span><span class="co">##   beta  0.133 0.137 -0.136  0.402</span></span>
<span><span class="co">##  gamma -2.512 1.041 -4.553 -0.471</span></span>
<span><span class="co">##  zeta1 -0.601 1.123 -2.802  1.601</span></span></code></pre>
<p>The estimate of the overall average effect is now 0.133, which is
over a third smaller than the estimate that does not account for
selection bias (0.217). This estimate is no longer statistically
distinct from zero, as indicated by the 95% confidence interval [-0.136,
0.402].</p>
<p>The estimates of the total heterogeneity parameter and the selection
parameter are on the log-scale. We can obtain an estimate of the total
variance by setting the argument <code>transf_gamma</code> to
<code>TRUE</code> in the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method. Similarly, we can
transform the selection parameter estimates to the probability scale by
setting <code>transf_zeta = TRUE</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod_3PSM</span>, transf_gamma <span class="op">=</span> <span class="cn">TRUE</span>, transf_zeta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     param    Est     SE   CI_lo CI_hi</span></span>
<span><span class="co">##      beta 0.1328 0.1373 -0.1363 0.402</span></span>
<span><span class="co">##      tau2 0.0811 0.0845  0.0105 0.625</span></span>
<span><span class="co">##  lambda_1 0.5485 0.6160  0.0607 4.956</span></span></code></pre>
<p>The estimated total heterogeneity of 0.081 is slightly smaller than
the total heterogeneity estimate from the CHE model, but is also very
imprecisely estimated. The selection parameter is now called
<code>lambda_1</code>. The estimate of 0.548 indicates that effect size
estimates with one-sided p-values greater than .025 are only about half
as likely to be reported as estimates that are positive and
statistically significant (i.e., estimates with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>.025</mn></mrow><annotation encoding="application/x-tex">p &lt; .025</annotation></semantics></math>).</p>
<p>The <code>metaselection</code> package provides a function
<code><a href="../reference/selection_plot.html">selection_plot()</a></code> to visualize the estimated selection
weights:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/selection_plot.html">selection_plot</a></span><span class="op">(</span><span class="va">mod_3PSM</span><span class="op">)</span></span></code></pre></div>
<p><img src="selection_models_files/figure-html/3PSM-plot-1.png" width="700"></p>
<p>The plot illustrates how the likelihood of selection differs as a
function of the one-sided p-value of an effect size estimate. In this
example, the plot shows that studies with p-values &gt; 0.025 are about
half as likely
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mn>1</mn></msub><mo>=</mo><mn>0.548</mn></mrow><annotation encoding="application/x-tex">\lambda_1 = 0.548</annotation></semantics></math>)
to be published than studies with smaller p-values.</p>
</div>
<div class="section level3">
<h3 id="four-parameter-step-model-with-rve">Four-Parameter Step Model with RVE<a class="anchor" aria-label="anchor" href="#four-parameter-step-model-with-rve"></a>
</h3>
<p>Rather than using a single threshold at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ±</mi><mn>1</mn></msub><mo>=</mo><mn>.025</mn></mrow><annotation encoding="application/x-tex">\alpha_1 = .025</annotation></semantics></math>,
we could fit a model that also allows the selection probability for
negative effect size estimates to differ from the selection probability
for positive but non-significant estimates. The following code fits such
a model, setting <code>steps = c(.025, .500)</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_4PSM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selection_model.html">selection_model</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat.lehmann2018</span>, </span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  cluster <span class="op">=</span> <span class="va">study</span>,</span>
<span>  selection_type <span class="op">=</span> <span class="st">"step"</span>,</span>
<span>  steps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">.500</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod_4PSM</span>, transf_gamma <span class="op">=</span> <span class="cn">TRUE</span>, transf_zeta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     param    Est     SE   CI_lo CI_hi</span></span>
<span><span class="co">##      beta 0.0725 0.1590 -0.2392 0.384</span></span>
<span><span class="co">##      tau2 0.0842 0.0907  0.0102 0.695</span></span>
<span><span class="co">##  lambda_1 0.5022 0.6111  0.0463 5.453</span></span>
<span><span class="co">##  lambda_2 0.3410 0.5097  0.0182 6.383</span></span></code></pre>
<p>The estimate of the overall average effect is 0.073, even smaller
than the estimated effect from the three-parameter step model and only
one third the magnitude of the estimate that does not account for
selection bias (0.217).</p>
<p>We can visualize the estimated selection function with
<code><a href="../reference/selection_plot.html">selection_plot()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/selection_plot.html">selection_plot</a></span><span class="op">(</span><span class="va">mod_4PSM</span><span class="op">)</span></span></code></pre></div>
<p><img src="selection_models_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>As is apparent from the plot, this estimated model indicates that
negatively signed effects (i.e., those with a one-sided p-value greater
than .50) are even less likely to be observed than effects that are
positive but not statistically significant. However, as can be seen from
the robust confidence intervals in the model output, the selection
parameters are very imprecisely estimated.</p>
</div>
<div class="section level3">
<h3 id="beta-function-with-rve">Beta Function with RVE<a class="anchor" aria-label="anchor" href="#beta-function-with-rve"></a>
</h3>
<p>The <code><a href="../reference/selection_model.html">selection_model()</a></code> function also allows fitting
models based on beta density selection functions by specifying
<code>selection_type = "beta"</code>. The default estimator for the beta
function model is maximum likelihood; the hybrid estimator is not yet
available.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selection_model.html">selection_model</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat.lehmann2018</span>, </span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  cluster <span class="op">=</span> <span class="va">study</span>,</span>
<span>  selection_type <span class="op">=</span> <span class="st">"beta"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod_beta</span>, transf_gamma <span class="op">=</span> <span class="cn">TRUE</span>, transf_zeta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     param    Est    SE  CI_lo CI_hi</span></span>
<span><span class="co">##      beta -0.122 0.125 -0.366 0.123</span></span>
<span><span class="co">##      tau2  0.165 0.150  0.028 0.977</span></span>
<span><span class="co">##  lambda_1  0.910 0.460  0.338 2.451</span></span>
<span><span class="co">##  lambda_2  1.610 0.337  1.067 2.427</span></span></code></pre>
<p>The estimate of the overall average effect is -0.122, which is
smaller than both the estimate that does not account for selection bias
(0.217) and the estimates from the three- and four-parameter step
function models. The average effect estimate based on the beta function
is not statistically distinct from zero, as indicated by the 95%
confidence intervals [-0.366, 0.123].</p>
<p>To see how the probability of selection differs across studies with
different p-values, we can again visualize the selection function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/selection_plot.html">selection_plot</a></span><span class="op">(</span><span class="va">mod_beta</span><span class="op">)</span></span></code></pre></div>
<p><img src="selection_models_files/figure-html/beta-plot-1.png" width="700"></p>
<p>The plot shows that effect sizes with smaller p-values are more
likely to be published than effects with larger p-values. For example,
an effect size estimate of zero (with one-sided p-value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>.500</mn></mrow><annotation encoding="application/x-tex">p = .500</annotation></semantics></math>)
is about half as likely to be published as an effect with a
statistically significant, positive effect.</p>
</div>
<div class="section level3">
<h3 id="bootstrap-confidence-intervals">Bootstrap Confidence Intervals<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals"></a>
</h3>
<p>Rather than relying on robust variance estimation to construct
standard errors and confidence intervals, we can use cluster-wise
bootstrap resampling. The code below re-fits the three-parameter step
function model to obtain cluster-bootstrap confidence intervals. We
specify <code>bootstrap = "multinomial"</code> to run cluster
bootstrapping and we specify that we want <code>"percentile"</code>
bootstrap confidence intervals. We specify that number of bootstraps by
setting R to <code>99</code>. We set the value to 99 here solely to
limit the amount of computation. In practice, we recommend using a much
higher number of bootstrap replications, such as 1999, to obtain
confidence intervals with more accurate coverage rates <span class="citation">(<a href="#ref-davidson2000bootstrap">Davidson &amp;
MacKinnon, 2000</a>)</span>. We highly recommend running the selection
models with cluster bootstrapping, particularly the regular multinomial
bootstrap with percentile confidence intervals, as this has been shown
to improve confidence interval coverage rates relative to using other
forms of bootstrap confidence intervals.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20240916</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">mod_3PSM_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/selection_model.html">selection_model</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dat.lehmann2018</span>, </span>
<span>    yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>    sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>    cluster <span class="op">=</span> <span class="va">study</span>,</span>
<span>    selection_type <span class="op">=</span> <span class="st">"step"</span>,</span>
<span>    steps <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>    CI_type <span class="op">=</span> <span class="st">"percentile"</span>,</span>
<span>    bootstrap <span class="op">=</span> <span class="st">"multinomial"</span>,</span>
<span>    R <span class="op">=</span> <span class="fl">99</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##  12.194   0.031  12.259</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod_3PSM_boot</span>, transf_gamma <span class="op">=</span> <span class="cn">TRUE</span>, transf_zeta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     param    Est     SE percentile_lower percentile_upper</span></span>
<span><span class="co">##      beta 0.1328 0.1373        -4.51e-03            0.440</span></span>
<span><span class="co">##      tau2 0.0811 0.0845         5.54e-17            0.244</span></span>
<span><span class="co">##  lambda_1 0.5485 0.6160         6.38e-02            2.942</span></span></code></pre>
<p>The overall estimate of the average effect does not change when
bootstrapping is applied (0.133). However, the confidence internal is
narrower, [-0.005, 0.44] (due to the use of a smaller-than-desirable
number of bootstrap replications).</p>
<p>The bootstrapping routine is implemented to work with the
<code>future</code> and <code>future.apply</code> packages for parallel
processing. For example, the following code specifies to use a
<code>multisession</code> future processing plan with 4 worker nodes,
then fits the same model as above:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org" class="external-link">future.apply</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/selection_model.html">selection_model</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dat.lehmann2018</span>, </span>
<span>    yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>    sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>    cluster <span class="op">=</span> <span class="va">study</span>,</span>
<span>    selection_type <span class="op">=</span> <span class="st">"step"</span>,</span>
<span>    steps <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>    CI_type <span class="op">=</span> <span class="st">"percentile"</span>,</span>
<span>    bootstrap <span class="op">=</span> <span class="st">"multinomial"</span>,</span>
<span>    R <span class="op">=</span> <span class="fl">99</span></span>
<span>  <span class="op">)</span>  </span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   0.380   0.007   2.639</span></span></code></pre>
<p>Setting a <code>sequential</code> plan will stop the use of parallel
processing:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-boos2003introduction" class="csl-entry">
Boos, D. D. (2003). Introduction to the bootstrap world. <em>Statistical
Science</em>, <em>18</em>(2), 168‚Äì174.
</div>
<div id="ref-citkowicz_parsimonious_2017" class="csl-entry">
Citkowicz, M., &amp; Vevea, J. L. (2017). A parsimonious weight function
for modeling publication bias. <em>Psychological Methods</em>,
<em>22</em>(1), 28‚Äì41. <a href="https://doi.org/10.1037/met0000119" class="external-link">https://doi.org/10.1037/met0000119</a>
</div>
<div id="ref-davidson2000bootstrap" class="csl-entry">
Davidson, R., &amp; MacKinnon, J. G. (2000). Bootstrap tests: How many
bootstraps? <em>Econometric Reviews</em>, <em>19</em>(1), 55‚Äì68.
</div>
<div id="ref-hedges_modeling_1992" class="csl-entry">
Hedges, L. V. (1992). Modeling <span>Publication</span>
<span>Selection</span> <span>Effects</span> in
<span>Meta</span>-<span>Analysis</span>. <em>Statistical Science</em>,
<em>7</em>(2), 246‚Äì255. <a href="https://doi.org/10.1214/ss/1177011364" class="external-link">https://doi.org/10.1214/ss/1177011364</a>
</div>
<div id="ref-rothstein_selection_2006" class="csl-entry">
Hedges, L. V., &amp; Vevea, J. (2006). Selection <span>Method</span>
<span>Approaches</span>. In H. R. Rothstein, A. J. Sutton, &amp; M.
Borenstein (Eds.), <em>Publication <span>Bias</span> in
<span>Meta</span>-<span>Analysis</span></em> (pp. 145‚Äì174). <a href="https://doi.org/10.1002/0470870168.ch9" class="external-link">https://doi.org/10.1002/0470870168.ch9</a>
</div>
<div id="ref-lehmann2018meta" class="csl-entry">
Lehmann, G. K., Elliot, A. J., &amp; Calin-Jageman, R. J. (2018).
Meta-analysis of the effect of red on perceived attractiveness.
<em>Evolutionary Psychology</em>, <em>16</em>(4), 1474704918802412.
</div>
<div id="ref-pustejovsky2022preventionscience" class="csl-entry">
Pustejovsky, J. E., &amp; Tipton, E. (2022). Meta-Analysis with Robust
Variance Estimation: <span>Expanding</span> the Range of Working Models.
<em>Prevention Science</em>, <em>23</em>, 425‚Äì438. <a href="https://doi.org/10.1016/j.jsp.2018.02.003" class="external-link">https://doi.org/10.1016/j.jsp.2018.02.003</a>
</div>
<div id="ref-vevea_general_1995" class="csl-entry">
Vevea, J. L., &amp; Hedges, L. V. (1995). A general linear model for
estimating effect size in the presence of publication bias.
<em>Psychometrika</em>, <em>60</em>(3), 419‚Äì435. <a href="https://doi.org/10.1007/BF02294384" class="external-link">https://doi.org/10.1007/BF02294384</a>
</div>
<div id="ref-viechtbauer_locationscale_2022" class="csl-entry">
Viechtbauer, W., &amp; L√≥pez‚ÄêL√≥pez, J. A. (2022). Location‚Äêscale models
for meta‚Äêanalysis. <em>Research Synthesis Methods</em>, jrsm.1562. <a href="https://doi.org/10.1002/jrsm.1562" class="external-link">https://doi.org/10.1002/jrsm.1562</a>
</div>
<div id="ref-metadat" class="csl-entry">
White, T., Noble, D., Senior, A., Hamilton, W. K., &amp; Viechtbauer, W.
(2022). <em>Metadat: Meta-analysis datasets</em>. Retrieved from <a href="https://CRAN.R-project.org/package=metadat" class="external-link">https://CRAN.R-project.org/package=metadat</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.jepusto.com/" class="external-link">James Pustejovsky</a>, <a href="https://meghapsimatrix.com/" class="external-link">Megha Joshi</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
